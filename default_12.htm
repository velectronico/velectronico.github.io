<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=Windows-1252"/>
 <meta name="Generator" content="Xara HTML filter v.6.0.4.417"/>
 <meta name="XAR Files" content="default_htm_files/xr_files.txt"/>
 <title>default_12</title>
 <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
 <link rel="stylesheet" type="text/css" href="default_htm_files/xr_main.css"/>
 <link rel="stylesheet" type="text/css" href="default_htm_files/xr_text.css"/>
 <link rel="stylesheet" type="text/css" href="default_htm_files/custom_styles.css"/>
 <script type="text/javascript" src="default_htm_files/roe.js"></script>
</head>
<body style="background-color: #FFFFFF">
<div class="xr_ap" id="xr_xr" style="width: 1005px; height: 8744px; top:0px; left:50%; margin-left: -503px;">
 <script type="text/javascript">var xr_xr=document.getElementById("xr_xr")</script>
 <span class="xr_ar" style="left: 0px; top: 0px; width: 1005px; height: 8744px; background-color: #FFF7FB;"></span>
 <div class="xr_s1" style="position: absolute; left:54px; top:192px;">
  <span class="xr_tl xr_s1" style="top: -19px;"><span id="Electr:243nica:32de:32control">Electr&#243;nica de control</span></span>
 </div>
 <div class="xr_s2" style="position: absolute; left:56px; top:221px;">
  <span class="xr_tl xr_s2" style="top: -11px;">Aunque el sistema no requiere de ning&#250;n tipo de manipulaci&#243;n, se ha incorporado un interruptor en el habit&#225;culo para poder activarlo o desconectarlo a </span>
  <span class="xr_tl xr_s2" style="top: 3px;">voluntad.</span>
  <span class="xr_tl xr_s2" style="top: 31px;">Dicho interruptor act&#250;a sobre un rel&#233; que incorpora el circuito de control. Por ello la l&#237;nea de control puede ser un cable de secci&#243;n reducida.</span>
  <span class="xr_tl xr_s2" style="top: 58px;">Es complicado encontrar una comunicaci&#243;n del vano del motor al habit&#225;culo para pasar el cable, todo est&#225; completamente sellado y de dif&#237;cil acceso.</span>
  <span class="xr_tl xr_s2" style="top: 86px;">Pude encontrar un resquicio detr&#225;s del guardabarros en la rueda delantera izquierda, junto al pilar que sujeta la puerta del mismo lado y perforando unos </span>
  <span class="xr_tl xr_s2" style="top: 100px;">tapones de pl&#225;stico que comunicaban con el interior.</span>
 </div>
 <img class="xr_ap" src="default_htm_files/461.jpg" alt="" title="" style="left: 37px; top: 797px; width: 456px; height: 607px;"/>
 <div class="xr_s4" style="position: absolute; left:95px; top:756px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Quitando el guardabarros de la rueda delantera izquierda y a trav&#233;s del pilar que sujeta la puerta podemos comunicar el alojamiento del motor con el habit&#225;culo.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:37px; top:1438px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Es necesario quitar elementos del tapizado y el tirador de la apertura del cap&#243; para hacerse hueco hasta localizar unos tapones de pl&#225;stico que se pueden ver en el interior de la aleta.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:518px; top:1700px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Como gu&#237;a he utilizado un peque&#241;o retal de cable que nos permitir&#225; encaminar la manguera </span>
  <span class="xr_tl xr_s4" style="top: 2px;">definitiva.</span>
  <span class="xr_tl xr_s4" style="top: 28px;">Hay que tener cuidado a la hora de perforar el tap&#243;n exterior para evitar hacer el agujero</span>
  <span class="xr_tl xr_s4" style="top: 41px;">demasiado grande (peligro de filtraciones), solo lo necesario para pasar la manguera.</span>
  <span class="xr_tl xr_s4" style="top: 66px;">En el caso del tap&#243;n interior, cuanto m&#225;s grande hag&#225;is el agujero menos trabajo costar&#225; </span>
  <span class="xr_tl xr_s4" style="top: 79px;">pasar el cable.</span>
  <span class="xr_tl xr_s4" style="top: 105px;">No est&#225; de m&#225;s sellar con masilla el paso de cable en el tap&#243;n exterior de la aleta.</span>
  <span class="xr_tl xr_s4" style="top: 130px;">El recorrido final se realiza por la parte trasera del faro pegado al guardabarros y se puede</span>
  <span class="xr_tl xr_s4" style="top: 143px;">guiar f&#225;cilmente hasta la caja de control localizada junto al dep&#243;sito de electrolito.</span>
  <span class="xr_tl xr_s4" style="top: 168px;">En el lado del habit&#225;culo canalizo el cable junto al resto de mangueras y sit&#250;o el interruptor </span>
  <span class="xr_tl xr_s4" style="top: 181px;">detr&#225;s del cenicero.</span>
 </div>
 <div class="xr_s2" style="position: absolute; left:41px; top:2158px;">
  <span class="xr_tl xr_s2" style="top: -11px;">Terminada esta primera l&#237;nea de control, es necesario canalizar la alimentaci&#243;n de potencia desde la bater&#237;a hasta nuestra electr&#243;nica.</span>
  <span class="xr_tl xr_s2" style="top: 17px;">En este caso es necesario ser generosos con la secci&#243;n del cable ya que estamos manejando corrientes por encima de los 10A. Con 4mm de secci&#243;n tendremos </span>
  <span class="xr_tl xr_s2" style="top: 31px;">garantizada la seguridad de la instalaci&#243;n.</span>
  <span class="xr_tl xr_s2" style="top: 58px;">La toma de alimentaci&#243;n la cogeremos de uno de los fusibles que est&#225; sin uso (el perteneciente a la caja manual comandada) del grupo situado en la parte </span>
  <span class="xr_tl xr_s2" style="top: 72px;">superior de la bater&#237;a. El negativo lo tomo directamente del chasis, en uno de los tornillos de la viga que sujeta nuestro dep&#243;sito.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:37px; top:2678px;">
  <span class="xr_tl xr_s4" style="top: -10px;">La toma de alimentaci&#243;n en este punto es limpia y de f&#225;cil acceso. El amperaje del fusible </span>
  <span class="xr_tl xr_s4" style="top: 2px;">original est&#225; sobredimensionado por lo que hay que tener presente el sustituirlo por uno lo </span>
  <span class="xr_tl xr_s4" style="top: 15px;">m&#225;s aproximado a 15A.</span>
  <span class="xr_tl xr_s4" style="top: 41px;">La interconexi&#243;n con la electr&#243;nica la realizaremos con grupos de conectores faston.</span>
 </div>
 <div class="xr_s2" style="position: absolute; left:40px; top:2988px;">
  <span class="xr_tl xr_s2" style="top: -11px;">Un &#250;ltimo cable es necesario para controlar la producci&#243;n de HHO. Cuando el inyector no est&#225; metiendo combustible a la c&#225;mara de combusti&#243;n no es</span>
  <span class="xr_tl xr_s2" style="top: 3px;">necesario producir hidr&#243;geno ya que este no se aprovecha (no se quema), esto sucede cuando deceleramos o tenemos el motor parado. </span>
  <span class="xr_tl xr_s2" style="top: 31px;">Como medida de seguridad extra viene perfecto para evitar que se est&#233; produciendo hidr&#243;geno y se acumule cuando tenemos el contacto puesto con el motor </span>
  <span class="xr_tl xr_s2" style="top: 44px;">parado.</span>
  <span class="xr_tl xr_s2" style="top: 72px;">Para conocer si se est&#225; inyectando combustible tomaremos la actividad de uno de los inyectores a trav&#233;s de la inducci&#243;n producida en el cable que lo alimenta. </span>
  <span class="xr_tl xr_s2" style="top: 100px;">Con un peque&#241;o n&#250;mero de espiras junto al cable del inyector podremos tomar la se&#241;al que lo controla y evitaremos manipular l&#237;neas activas.</span>
  <span class="xr_tl xr_s2" style="top: 128px;">Esta se&#241;al la llevaremos a la electr&#243;nica de control con un cable apantallado de secci&#243;n reducida. Dada la proximidad de elementos del motor con temperatura </span>
  <span class="xr_tl xr_s2" style="top: 142px;">elevada evitaremos que el cable est&#233; pr&#243;ximo a estas zonas.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:48px; top:3540px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Con solamente uno de los hilos que alimenta el inyector podremos tomar una muestra </span>
  <span class="xr_tl xr_s4" style="top: 2px;">de se&#241;al que nos servir&#225; para comprobar la actividad del motor.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:524px; top:3540px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Una peque&#241;a clema de electricista nos servir&#225; para unir el cable esmaltado con la l&#237;nea </span>
  <span class="xr_tl xr_s4" style="top: 2px;">coaxial.</span>
 </div>
 <div class="xr_s2" style="position: absolute; left:40px; top:3622px;">
  <span class="xr_tl xr_s2" style="top: -11px;">La inteligencia del sistema recae en la electr&#243;nica de control que se encarga de las siguientes funciones:</span>
  <span class="xr_tl xr_s2" style="top: 31px;">Activaci&#243;n del sistema en remoto.</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 58px;">El interruptor utilizado para activar el sistema puede ser de reducidas dimensiones y/o baja potencia y alojarse discretamente en cualquier lugar del </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 72px;">habit&#225;culo. La entrega de potencia la realizan el rel&#233; de la electr&#243;nica.</span>
  <span class="xr_tl xr_s2" style="top: 114px;">Regulaci&#243;n de corriente de la c&#233;lula mediante PWM.</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 142px;">El consumo de corriente por la c&#233;lula var&#237;a dependiendo de la densidad del electrolito y su temperatura. Por esto es importante tener continuamente </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 156px;">supervisada la corriente que circula y regular mediante PWM.</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 184px;">Cuando se llena por primera vez el dep&#243;sito con agua se introduce poco a poco las pastillas de potasa hasta que alcanzas un consumo de 8A a </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 198px;">temperatura ambiente. Es necesario respetar un tiempo de reposo e ir a&#241;adiendo d&#237;a a d&#237;a la cantidad necesaria de potasa hasta alcanzar la corriente </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 212px;">mencionada.</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 240px;">Aunque por programaci&#243;n se ha optado por un consumo de 10A, estos se alcanzan f&#225;cilmente cuando se calienta el electrolito despu&#233;s de permanecer</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 253px;">un tiempo funcionando. A partir de ese momento el sistema PWM nos regular&#225; la corriente y evitar&#225; que el consumo se incremente excesivamente.</span>
  <span class="xr_tl xr_s2" style="top: 295px;">Supervisi&#243;n de la inyecci&#243;n de combustible.</span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 323px;">Mantendremos el sistema produciendo hidr&#243;geno solamente cuando el motor este inyectando combustible. El hidr&#243;geno es peligroso y conseguiremos </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 337px;">cortar la producci&#243;n en los momentos que no son necesarios.</span>
  <span class="xr_tl xr_s2" style="top: 379px;">Monitorizaci&#243;n de corriente y tensi&#243;n. </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 407px;">Continuamente se supervisa la corriente consumida por la c&#233;lula y la tensi&#243;n. Estos datos son enviados a un smartphone junto con la informaci&#243;n de la </span>
  <span class="xr_tl xr_s2" style="left: 38px; top: 421px;">actividad de la c&#233;lula (si se ha cortado la producci&#243;n de HHO) y el porcentaje de regulaci&#243;n PWM.</span>
  <span class="xr_tl xr_s2" style="top: 476px;">El circuito de control est&#225; montado sobre una placa est&#225;ndar de prototipos. Hay que respetar unas secciones m&#237;nimas entre las conexiones de entrada de </span>
  <span class="xr_tl xr_s2" style="top: 490px;">alimentaci&#243;n y la salida hacia la c&#233;lula. Para el resto del conexionado se ha utilizado cable de puentes.</span>
  <span class="xr_tl xr_s2" style="top: 518px;">Lo primero que nos encontramos es el conjunto de rel&#233;s en cascada que activan el sistema. El RL1 es importante que soporte 20A.</span>
  <span class="xr_tl xr_s2" style="top: 546px;">La entrada RA0 del PIC16F886 nos medir&#225; la corriente consumida por la c&#233;lula y en patilla RA1 se toma una muestra de la tensi&#243;n de alimentaci&#243;n.</span>
  <span class="xr_tl xr_s2" style="top: 574px;">El diodo BY251 junto con el filtro formado por L1 y C9 y C10 nos evitan tener fuertes sobrecorrientes y picos de tensi&#243;n que generan gran cantidad de ruido </span>
  <span class="xr_tl xr_s2" style="top: 588px;">el&#233;ctrico y pueden llegar a ser da&#241;inas para el resto de los sistemas.</span>
  <span class="xr_tl xr_s2" style="top: 616px;">La salida de potencia est&#225; formada por los MOS IRFZ44N que es necesario protegerlos con un radiador para mejorar la disipaci&#243;n de potencia. Tambi&#233;n al </span>
  <span class="xr_tl xr_s2" style="top: 630px;">regulador de tensi&#243;n 7805 es necesario a&#241;adirle un peque&#241;o disipador.</span>
  <span class="xr_tl xr_s2" style="top: 658px;">Como enlace bluetooth se ha utilizado el m&#243;dulo hibrido HC-06 que nos servir&#225; de medio para el env&#237;o de informaci&#243;n v&#237;a radio.</span>
  <span class="xr_tl xr_s2" style="top: 685px;">La captaci&#243;n de la se&#241;al del inyector es tomada a trav&#233;s de la peque&#241;a bobina L2 que tras amplificarla y filtrarla por U5 y U6 se la entregamos al PIC en la </span>
  <span class="xr_tl xr_s2" style="top: 699px;">entrada RB0.</span>
 </div>
 <img class="xr_ap" src="default_htm_files/462.png" alt="FU 15A D1 BY251 D2 1N4004 R1 620 R2 150 RA0/AN0/ULPWU/C12IN0- 2 RA1/AN1/C12IN1- 3 RA2/AN2/VREF-/CVREF/C2IN+ 4 RA4/T0CKI/C1OUT 6 RA5/AN4/SS/C2OUT 7 RB0/AN12/INT 21 RB1/AN10/P1C/C12IN3- 22 RB2/AN8/P1B 23 RA7/OSC1/CLKIN 9 RA6/OSC2/CLKOUT 10 RC0/T1OSO/T1CKI 11 RC1/T1OSI/CCP2 12 RB7/ICSPDAT 28 RB6/ICSPCLK 27 RB5/AN13/T1G 26 RB4/AN11/P1D 25 RC7/RX/DT 18 RC6/TX/CK 17 RC5/SDO 16 RC4/SDI/SDA 15 RC3/SCK/SCL 14 RC2/CCP1/P1A 13 RA3/AN3/VREF+/C1IN+ 5 RB3/AN9/PGM/C12IN2- 24 RE3/MCLR/VPP 1 U1 PIC16F886 RL1 Relé potencia 20A C1 100nF C2 1nF C3 4700uF  25V 1uF 10k VI 1 VO 3 GND 2 U2 7805 C5 1uF C6 1uF VI 1 VO 3 GND 2 U3 7809 C7 1uF C8 1uF R4 330 R5 330 Q1 BC548 Q2 BC548 R6 3k3 R7 1k R8 22 R9 100k Q3 IRFZ44N Q4 IRFZ44N R10 22 R11 100k C9 4700uF  25V C10 4700uF  25V L1 10uH + Celula HHO - Celula HHO RL2 Relé 5V D4 1N4004 D5 1N4004 C11 10uF +5V D6 LED R12 10k SW Int. seguridad habitáculo +12V +12V Bateria IP+ 1/2 IP- 3/4 VIOUT 7 VCC 8 GND 5 FILTER 6 U4 ACS712ELCTR-20A-T C12 1uF +5V R14 10k C13 4nF Rx Tx GND Vcc HC-06 C14 1uF +5V 3 2 1 8 4 U5:A TL072 5 6 7 8 4 U5:B TL072 L2 Det. Inyector +9V C15 10nF R13 100k R15 100k R16 1k R17 100k C16 100nF C17 100nF R18 47k R19 1k R 4 DC 7 Q 3 GND 1 VCC 8 TR 2 TH 6 CV 5 U6 555 C19 10nF C20 4,7uF R20 100k +5V +5V D3 LED R21 330 D7 1N4004 R22 10k R23 100k C21 4,7uF +9V C18 1uF" title="" style="left: 18px; top: 4373px; width: 987px; height: 1253px;"/>
 <div class="xr_s4" style="position: absolute; left:347px; top:5662px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Esquema el&#233;ctrico encargado de controlar la producci&#243;n de HHO.</span>
 </div>
 <div class="xr_s4" style="position: absolute; left:304px; top:6097px;">
  <span class="xr_tl xr_s4" style="top: -10px;">Las reducidas dimensiones del circuito hace posible alojar el conjunto f&#225;cilmente.</span>
 </div>
 <img class="xr_ap" src="default_htm_files/2607.png" alt="Firmware microcontrolador ;------------------------------------------------------------------ ; ;	Control PWM y supervisor de corriente en sistema  ;		HHO para Peugeot 308. ; ;------------------------------------------------------------------  	LIST P=16F886 	INCLUDE  &lt;P16F886.INC&gt; 	processor PIC16F886  ;--&lt; config settings &gt;--------------------------------------------- __CONFIG  _CONFIG1, _INTOSCIO &amp; _BOR_OFF &amp; _IESO_OFF &amp; _CPD_OFF &amp; _CP_OFF  &amp; _MCLRE_OFF &amp; _LVP_OFF &amp; _FCMEN_OFF &amp; _PWRTE_ON &amp; _WDT_OFF &amp; _DEBUG_OFF __CONFIG  _CONFIG2, _WRT_OFF &amp; _BOR40V  ;--&lt; constants &gt;--------------------------------------------------- ;Imax	equ	D&#39;110&#39;	; 11,0 Amp ;Imin	equ	D&#39;100&#39;	; 10,0 Amp  Imax	equ	D&#39;110&#39; Imin	equ	D&#39;100&#39;   ;--&lt; variables &gt;--------------------------------------------------- 	CBLOCK 0x70 		Delay_1		;temporizador 1. 		Delay_2		;temporizador 2. 		Delay_3		;temporizador 3. 		Valor_I		;Valor intensidad (A/D conv). 		Valor_V		;Valor voltaje Bateria (A/D conv). 		Valor_PWM	;Valor porcentage modulador PWM. 		DecBCD_0	;Digito 0 conv. Bin-BCD. 		DecBCD_1	;Digito 1 conv. Bin-BCD. 		DecBCD_2	;Digito 2 conv. Bin-BCD. 	ENDC  	ORG	00h         	;startup = 0000H (Reset Vector). 	goto	Inicio 	  ;--&lt; Main Program &gt;------------------------------------------------  	ORG	05h		;startup = 0005H (Main Program). Inicio 	BANKSEL	OSCCON 	movlw	B&#39;01110000&#39;	;Inic clock 8Mhz INTRC 	movwf	OSCCON^80H Stable 	btfss	OSCCON^80H,HTS	;INTOSC frequency stable? 	goto	Stable  	clrf	Valor_I		;Inic variable. 	clrf	Valor_V		;Inic variable. 	clrf	Valor_PWM	;Inic variable.  	call	IniINT		;Config. interrupciones. 	call	IniPORT		;Config. puertos. 	call	IniPWM		;Config. PWM.  ;--&lt; Bucle principal &gt;--------------------------------------------- MainLoop 	call	wait1s  	call	AD_ConversionV	;Tomar lectura Voltaje. 	call	AD_ConversionI	;Tomar lectura Intensidad. 	 	btfss	PORTB,RB0	;¿Se esta inyectando combustible? 	goto	SinInyeccion	;No se esta inyectando. 	 	call	RegIntensidad	;Regulacion PWM.  	movf	Valor_PWM,W	;Establecer ajuste PWM. 	movwf	CCPR1L  	call	Tx_Trama	;Enviar datos Bluetooth.  	goto	MainLoop  SinInyeccion 	call	AnularHHO	;Reducir hasta anular HHo  	movf	Valor_PWM,W	;Establecer ajuste PWM. 	movwf	CCPR1L  	call	Tx_Trama	;Enviar datos Bluetooth.  	goto	MainLoop  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Anular la produccion de HHO. ;	En caso de detectar que no se inyecta combustible, ;	la produccion de HHO se reduce hasta 0. ;------------------------------------------------------------------ AnularHHO 	movf	Valor_PWM,F	;¿Es 0 el valor de PWM? 	btfsc	STATUS,Z	 	return			;Ya no hay produccion de HHO.  	decf	Valor_PWM,F	;Seguir reduc.la produccion hasta 0. 	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Regulacion intensidad consumida por la celula HHO. ;------------------------------------------------------------------ RegIntensidad 	movf	Valor_I,W	;Comprobar valor max. intensidad.  	sublw	Imax 	btfsc	STATUS,C 	goto	CompImin	 	decf	Valor_PWM,F	;I&gt;Imax =&gt; reducir PWM. 	decf	Valor_PWM,F 	return  CompImin 	movf	Valor_I,W	;Comprobar valor min. intensidad. 	sublw	Imin 	btfss	STATUS,C 	return 	incf	Valor_PWM,W	;I&lt;Imin =&gt; aumentar PWM. 	sublw	D&#39;51&#39; 	btfss	STATUS,Z 	goto	IncPWM 	movlw	D&#39;50&#39;		;No sobrepasar el valor maximo de  	movwf	Valor_PWM	;de control PWM (D&#39;50&#39; = 100%) 	return  IncPWM 	incf	Valor_PWM,F  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Retardo (no hay prisa en hacer un anueva lectura). ;------------------------------------------------------------------ wait1s 	clrf	Delay_3 	clrf	Delay_2  	movlw	0x01 	movwf	Delay_1  wait1s_loop 	decfsz	Delay_3,F 	goto	wait1s_loop  	decfsz	Delay_2,F 	goto	wait1s_loop  	decfsz	Delay_1,F 	goto	wait1s_loop  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Lectura intensidad consumida por el generador HHO (AN0). ;------------------------------------------------------------------ AD_ConversionI 	BANKSEL ADCON0 	movlw	B&#39;01000001&#39;	;Fosc/8 - Canal AN0 - A/D enab. 	movwf	ADCON0  	nop 	bsf	ADCON0,GO	;Inicio nueva conversion. 	btfsc	ADCON0,GO	;¿Termino la conversion? 	goto	$-1		; 	 	movlw	D&#39;128&#39;		;restar 127 a la medida. 	subwf	ADRESH,F 	btfss	STATUS,C	;corrige inestabilidad sensor Hall. 	clrf	ADRESH	;si la corriente es negativa se deja a 0.	 	 	rlf	ADRESH,W	;multiplicar por 2.  	movwf	Valor_I		;guardar valor en variable.  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Lectura voltaje de la bateria (AN1). ;------------------------------------------------------------------ AD_ConversionV 	BANKSEL ADCON0 	movlw	B&#39;01000101&#39;	;Fosc/8 - Canal AN1 - A/D enab. 	movwf	ADCON0  	nop 	bsf	ADCON0,GO	;Inicio nueva conversion. 	btfsc	ADCON0,GO	;¿Termino la conversion? 	goto	$-1		;  	movf	ADRESH,W	;Lectura parte alta conver.  	movwf	Valor_V		;guardar valor en variable.  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Transmisión trama de informacion. ;------------------------------------------------------------------ Tx_Trama	  ;--&lt; Intensidad &gt;----------------------------------------------- 	movf	Valor_I,W 	call	bin2decBCD	;Convertir dato a BCD.  	movf	DecBCD_2,W 	call	Tx_USART 	movf	DecBCD_1,W 	call	Tx_USART 	movf	DecBCD_0,W 	call	Tx_USART                  ;--&lt; Voltaje &gt;-------------------------------------------------- 	movf	Valor_V,W 	call	bin2decBCD	;Convertir dato a BCD.  	movf	DecBCD_2,W 	call	Tx_USART 	movf	DecBCD_1,W 	call	Tx_USART 	movf	DecBCD_0,W 	call	Tx_USART  ;--&lt; PWM &gt;-------------------------------------------------- 	bcf	STATUS,C 	rlf	Valor_PWM,W	;multiplicar por 2. 	call	bin2decBCD	;Convertir dato a BCD.  	movf	DecBCD_2,W 	call	Tx_USART 	movf	DecBCD_1,W 	call	Tx_USART 	movf	DecBCD_0,W 	call	Tx_USART  ;--&lt; Inyeccion &gt;-------------------------------------------------- 	btfss	PORTB,RB0	;¿Se esta inyectando combustible? 	goto	NoInyeccion	;No se esta inyectando.  SiInyeccion 	movlw	A&#39;S&#39;		; 	call	Tx_USART 	goto	SaltarNoInyeccion  NoInyeccion 	movlw	A&#39;N&#39;		; 	call	Tx_USART SaltarNoInyeccion  ;--&lt; TX Sincronismo &gt;---------------------------------------------- 	movlw	D&#39;13&#39;		;Sincronismo trama. 	call	Tx_USART	;	&quot; 	movlw	D&#39;10&#39;		;	&quot; 	call	Tx_USART	;	&quot;  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Transmisión USART. ;------------------------------------------------------------------ Tx_USART 	BANKSEL	TXSTA 	btfss	TXSTA^80H,TRMT  ;¿Se puede transmitir? 	goto	$-1  	BANKSEL	TXREG 	movwf	TXREG		;Se transmite W.  	return  ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Covertidor binario a decima BCD. (from Daniel Serpell) ;------------------------------------------------------------------ bin2decBCD 	clrf	DecBCD_2 	clrf	DecBCD_1  	addlw	.56		;w &gt; 199? (200 a 255) 	btfss	STATUS,C 	goto	digit100 	bsf	DecBCD_2,1  	addlw	.176		;rango de 200 a 255. 	goto	digit40  digit100 	addlw	.100		;comprobar de 100 a 199. 	btfss	STATUS,C 	goto	$+3 	bsf	DecBCD_2,0 	addlw	.156  	addlw	.20		;comprobar de 0 a 99. 	btfss	STATUS,C 	goto	digit40 	bsf	DecBCD_1,3  	addlw	.236 	goto	digit10  digit40 	addlw	.40		;comprobar de 40 a 79. 	btfss	STATUS,C 	goto	$+3 	bsf	DecBCD_1,2 	addlw	.216  	addlw	.20		;comprobar de 20 a 39. 	btfss	STATUS,C 	goto	$+3 	bsf	DecBCD_1,1 	addlw	.236  digit10 	addlw	.10		;comprobar de 10 a 19. 	btfss	STATUS,C 	goto	$+3 	bsf	DecBCD_1,0 	addlw	.246  	addlw	.58		;comprobar de 0 a 9. 	movwf	DecBCD_0  	movlw	0x30 	xorwf	DecBCD_1,f 	xorwf	DecBCD_2,f      return ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Inicialización Interrupciones. Se anulan todas las interrup. ;------------------------------------------------------------------ IniINT		 	BANKSEL  INTCON 	CLRF	INTCON 	;Disable interrupts and clear T0IF  	CLRF	PIE1^80H	;Disable peripheral interrupts  	BANKSEL  PIR1 	CLRF	PIR1		;Clear peripheral interrupts Flags  	return ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	PORTA:  AN0	in	Medida Intensidad. ;		AN1	in	Medida Voltage. ;	PORTB:  RB0	in	Lectura estado inyeccion. ;	PORTC:  P1A	out	Salida control PWM. ;		TX	out	Enviar trama bluetooth (USART). ;------------------------------------------------------------------ IniPORT 	BANKSEL TRISA 	movlw	b&#39;11111111&#39; 	movwf	TRISA^80H	;RA0... RA7=in.  	BANKSEL ANSELH 	movlw	b&#39;00000000&#39;	;RB0... RB7 Digital I/O. 	movwf	ANSELH^180H 	BANKSEL TRISB 	movlw	b&#39;00000001&#39;	;RB0=in; RB1... RB7=out. 	movwf	TRISB^80H	  	movlw	b&#39;00001110&#39;	;Configurar convertidor A/D. 	movwf	ADCON1^80H	;Justif. izq. 				;ADRES a la izq. 				;Ref. VREF+=VDD y VREF-= VSS.  	bcf	TRISC^80H,RC6	;RC6/TX salida USART.  	movlw	d&#39;51&#39; 	movwf	SPBRG^80H	;Vel. TX = 9600bps @8Mhz.  	movlw	b&#39;00100100&#39; 	movwf	TXSTA^80H	;8 bits, TX-ON, SYNC=0, BRGH=1  	BANKSEL BAUDCTL 	bcf	BAUDCTL^180H,BRG16	;BRGH16=0  	BANKSEL ADCON0 	movlw	b&#39;10000001&#39;	;Fosc/32 - Canal 0 - A/D on. 	movwf	ADCON0  	bsf	RCSTA,SPEN	;Serial port Enable.  	return ;------------------------------------------------------------------   ;------------------------------------------------------------------ ;	Control PWM.  Fosc=8MHz -&gt; 10KHz,TimerPr=4,PR2=49,res.8bits ;------------------------------------------------------------------ IniPWM 	;PWM Period=[(PR2)+ 1]•4•1/FOSC•(TMR2 Prescale Value) 	;Pulse Width=(CCPRxL:CCPxCON&lt;5:4&gt;)•TOSC•(TMR2 Prescale Value  	BANKSEL TRISC 	bcf	TRISC^80H,RC2	;Pin RC2/CCP1 como salida  	BANKSEL PORTC 	bcf	PORTC,RC2	;Salida baja.  	BANKSEL CCP1CON 	clrf	CCP1CON	;PWM mode.  	BANKSEL PR2 	movlw	.49		;Frecuencia 10KHz 	movwf	PR2^80H  	BANKSEL CCPR1L 	movlw	.0		;.50 max.  .0 min. 	movwf	CCPR1L  	BANKSEL	T2CON 	movlw	B&#39;00000101&#39;	;Config. prescaler=1 Timer2=ON 	movwf	T2CON		;00=1, 01=4, 1x=16  	BANKSEL	CCP1CON		 	movlw	B&#39;00001100&#39;	;Single output (salida PWM por RC2) 	movwf	CCP1CON	;PWM mode.  	movlw	.0		;D&#39;0&#39;min... D&#39;50&#39;max. 	movwf	CCPR1L		;0%... 100% PWM.  	return ;------------------------------------------------------------------      END" title="" style="left: 43px; top: 6156px; width: 944px; height: 2471px;"/>
 <div class="xr_s4" style="position: absolute; left:54px; top:8609px;">
  <span class="xr_tl xr_s4" style="top: -10px;">El firmware del PIC se encarga de cuantificar los niveles de tensi&#243;n y corriente, controlar el m&#243;dulo PWM acorde al l&#237;mite que hemos establecido de corriente &#8220;Imax&#8221;, &#8220;Imin&#8221; y </span>
  <span class="xr_tl xr_s4" style="top: 2px;">transmitir en texto plano los datos que tiene que mostrar en el smartphone.</span>
  <span class="xr_tl xr_s4" style="top: 15px;">&nbsp;</span>
 </div>
<div class="xr_ap" id="xr_xri" style="width: 1005px; height: 8744px; overflow:hidden;">
 <img class="xr_ap" src="default_htm_files/464.jpg" alt="" title="" style="left: 37px; top: 376px; width: 456px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/465.jpg" alt="" title="" style="left: 281px; top: 5720px; width: 456px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/466.jpg" alt="" title="" style="left: 37px; top: 3170px; width: 456px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/467.jpg" alt="" title="" style="left: 37px; top: 2300px; width: 456px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/468.jpg" alt="" title="" style="left: 518px; top: 2300px; width: 455px; height: 607px;"/>
 <img class="xr_ap" src="default_htm_files/469.jpg" alt="" title="" style="left: 518px; top: 3170px; width: 455px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/470.jpg" alt="" title="" style="left: 518px; top: 376px; width: 455px; height: 342px;"/>
 <img class="xr_ap" src="default_htm_files/471.jpg" alt="" title="" style="left: 518px; top: 797px; width: 455px; height: 607px;"/>
 <img class="xr_ap" src="default_htm_files/472.jpg" alt="" title="" style="left: 37px; top: 1482px; width: 456px; height: 607px;"/>
 <img class="xr_ap" src="default_htm_files/53.png" alt="" title="" style="left: 19px; top: 18px; width: 973px; height: 120px;"/>
 <img class="xr_ap" src="default_htm_files/15.png" alt="" title="" style="left: 596px; top: 94px; width: 162px; height: 150px;"/>
 <!--[if IE]>
 <img class="xr_ap" src="default_htm_files/938.png" alt="Sistema HHO" title="" style="left: 391px; top: 70px; width: 235px; height: 50px;"/>
 <![endif]-->
 <!--[if !IE]>-->
 <div class="Heading_1" style="position: absolute; left:394px; top:109px;font-family:Impact;font-weight:normal;font-size:43px;color:#FFFFFF; text-shadow: 3px 3px 6px rgba(0,0,0,0.25);">
  <h1 class="xr_tl Heading_1" style="top: -43px;font-family:Impact;font-weight:normal;font-size:43px;color:#FFFFFF;margin:0;">Sistema HHO</h1>
 </div>
 <!--<![endif]-->
 <img class="xr_ap" src="default_htm_files/54.png" alt="" title="" style="left: 990px; top: 26px; width: 2px; height: 17px;"/>
 <div class="Normal_text" style="position: absolute; left:22px; top:37px;font-weight:bold;font-size:11px;color:#FFF7FB;">
  <span class="xr_tc Normal_text" style="left: -2px; top: -10px; width: 129px;font-weight:bold;font-size:11px;color:#FFF7FB;">Bricos Peugeot 308</span>
 </div>
 <div class="Normal_text" style="position: absolute; left:368px; top:37px;font-weight:bold;font-size:11px;color:#FFFFFF;">
  <span class="xr_tc Normal_text" style="left: 33px; top: -10px; width: 37px;font-weight:bold;font-size:11px;color:#FFFFFF;"><a href="index.html" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" ><span class="Normal_text" style="text-decoration:underline;font-weight:bold;font-size:11px;color:#FFFFFF;">Inicio</span></a></span>
 </div>
 <img class="xr_ap" src="default_htm_files/901.png" alt="" title="" style="left: 336px; top: 26px; width: 3px; height: 17px;"/>
 <div class="Normal_text" style="position: absolute; left:510px; top:37px;font-weight:bold;font-size:11px;color:#FFFFFF;">
  <span class="xr_tc Normal_text" style="left: -11px; top: -10px; width: 169px;font-weight:bold;font-size:11px;color:#FFFFFF;"><a href="default_2.htm" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" ><span class="Normal_text" style="text-decoration:underline;font-weight:bold;font-size:11px;color:#FFFFFF;">Modificaciones Interiores</span></a></span>
 </div>
 <img class="xr_ap" src="default_htm_files/902.png" alt="" title="" style="left: 500px; top: 26px; width: 3px; height: 17px;"/>
 <div class="Normal_text" style="position: absolute; left:701px; top:37px;font-weight:bold;font-size:11px;color:#FFFFFF;">
  <span class="xr_tc Normal_text" style="left: -5px; top: -10px; width: 101px;font-weight:bold;font-size:11px;color:#FFFFFF;"><a href="default_7.htm" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" ><span class="Normal_text" style="text-decoration:underline;font-weight:bold;font-size:11px;color:#FFFFFF;">Diagnosis OBD</span></a></span>
 </div>
 <img class="xr_ap" src="default_htm_files/903.png" alt="" title="" style="left: 663px; top: 26px; width: 3px; height: 17px;"/>
 <div class="Normal_text" style="position: absolute; left:872px; top:37px;font-weight:bold;font-size:11px;color:#FFFFFF;">
  <span class="xr_tc Normal_text" style="left: -6px; top: -10px; width: 88px;font-weight:bold;font-size:11px;color:#FFFFFF;"><a href="default_10.htm" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" ><span class="Normal_text" style="text-decoration:underline;font-weight:bold;font-size:11px;color:#FFFFFF;">Sistema HHO</span></a></span>
 </div>
 <img class="xr_ap" src="default_htm_files/904.png" alt="" title="" style="left: 826px; top: 26px; width: 3px; height: 17px;"/>
 <a href="default_11.htm" onclick="return(xr_nn());">
  <img class="xr_ap" src="default_htm_files/1610.png" alt="" title="" onmousemove="xr_mo(this,0,event)" style="left: 457px; top: 8669px; width: 52px; height: 52px;"/>
 </a>
 <a href="default_13.htm" onclick="return(xr_nn());">
  <img class="xr_ap" src="default_htm_files/1587.png" alt="" title="" onmousemove="xr_mo(this,0,event)" style="left: 492px; top: 8669px; width: 52px; height: 52px;"/>
 </a>
 <div class="Normal_text" style="position: absolute; left:541px; top:8697px;font-family:Trebuchet MS, Tahoma, sans-serif;font-size:11px;color:#4C4C4C;">
  <span class="xr_tl Normal_text" style="top: -10px;font-family:Trebuchet MS, Tahoma, sans-serif;font-size:11px;color:#4C4C4C;"><a href="default_13.htm" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" >P&#225;g. siguiente</a></span>
 </div>
 <div class="Normal_text" style="position: absolute; left:393px; top:8697px;font-family:Trebuchet MS, Tahoma, sans-serif;font-size:11px;color:#4C4C4C;">
  <span class="xr_tl Normal_text" style="top: -10px;font-family:Trebuchet MS, Tahoma, sans-serif;font-size:11px;color:#4C4C4C;"><a href="default_11.htm" onclick="return(xr_nn());" onmousemove="xr_mo(this,0)" >P&#225;g. anterior</a></span>
 </div>
 <div id="xr_xo0" class="xr_ap" style="left:0; top:0; width:1005px; height:100px; visibility:hidden;">
 <a href="" onclick="return(false);">
 </a>
 </div>
 <div id="xr_xd0"></div>
</div>
</div>
<!--[if lt IE 7]><script type="text/javascript" src="default_htm_files/png.js"></script><![endif]-->
<!--[if IE]><script type="text/javascript">xr_aeh()</script><![endif]--><!--[if !IE]>--><script type="text/javascript">window.addEventListener('load', xr_aeh, false);</script><!--<![endif]-->
</body>
</html>